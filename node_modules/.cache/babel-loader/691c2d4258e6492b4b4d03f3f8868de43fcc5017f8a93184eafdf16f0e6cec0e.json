{"ast":null,"code":"// frontend/src/components/ResultsPage.js\nimport React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import'./ResultsPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ResultsPage(_ref){let{user}=_ref;const{examId}=useParams();const navigate=useNavigate();const[results,setResults]=useState([]);const[examDetails,setExamDetails]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{fetchResults();},[examId]);const fetchResults=async()=>{try{setLoading(true);const token=localStorage.getItem('token');// Fetch exam details\nconst examResponse=await fetch(\"http://localhost:4000/api/exam/paper/\".concat(examId),{headers:{Authorization:\"Bearer \".concat(token)}});if(!examResponse.ok)throw new Error('Failed to load exam details');const examData=await examResponse.json();setExamDetails(examData);// Fetch results\nconst resultsResponse=await fetch(\"http://localhost:4000/api/exam/results/\".concat(examId),{headers:{Authorization:\"Bearer \".concat(token)}});if(!resultsResponse.ok)throw new Error('Failed to load results');const resultsData=await resultsResponse.json();setResults(resultsData);}catch(err){console.error('Error fetching results:',err);setError(err.message||'Failed to load results');}finally{setLoading(false);}};const handleBack=()=>{if(user.role==='admin'){navigate('/admin/dashboard');}else{navigate('/student/dashboard');}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"results-container loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading results...\"})]});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"results-container error\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Error\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:handleBack,className:\"btn-back\",children:\"Back to Dashboard\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"results-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"results-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Exam Results\"}),examDetails&&/*#__PURE__*/_jsx(\"h2\",{children:examDetails.title}),/*#__PURE__*/_jsx(\"button\",{onClick:handleBack,className:\"btn-back\",children:\"Back to Dashboard\"})]}),results.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No results available for this exam yet.\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"results-table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"results-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Student\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Score\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Percentage\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Submission Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Proctoring Violations\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:results.map(result=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:result.studentName}),/*#__PURE__*/_jsxs(\"td\",{children:[result.score,\" / \",result.totalQuestions]}),/*#__PURE__*/_jsxs(\"td\",{children:[Math.round(result.score/result.totalQuestions*100),\"%\"]}),/*#__PURE__*/_jsx(\"td\",{children:new Date(result.submittedAt).toLocaleString()}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"violation-indicators\",children:[result.tabSwitches>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"violation-badge\",title:\"\".concat(result.tabSwitches,\" tab switches detected\"),children:[\"\\uD83D\\uDD04 \",result.tabSwitches]}),result.faceVerificationFailures>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"violation-badge\",title:\"\".concat(result.faceVerificationFailures,\" face verification failures\"),children:[\"\\uD83D\\uDC64\\u274C \",result.faceVerificationFailures]}),result.multipleFaceDetections>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"violation-badge\",title:\"\".concat(result.multipleFaceDetections,\" multiple face detections\"),children:[\"\\uD83D\\uDC65 \",result.multipleFaceDetections]}),result.noFaceDetections>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"violation-badge\",title:\"\".concat(result.noFaceDetections,\" periods with no face detected\"),children:[\"\\uD83D\\uDC64\\u2753 \",result.noFaceDetections]}),!result.tabSwitches&&!result.faceVerificationFailures&&!result.multipleFaceDetections&&!result.noFaceDetections&&/*#__PURE__*/_jsx(\"span\",{className:\"clean-badge\",children:\"\\u2705 None\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/result/\".concat(result._id)),className:\"btn-view-details\",children:\"View Details\"})})]},result._id))})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","ResultsPage","_ref","user","examId","navigate","results","setResults","examDetails","setExamDetails","loading","setLoading","error","setError","fetchResults","token","localStorage","getItem","examResponse","fetch","concat","headers","Authorization","ok","Error","examData","json","resultsResponse","resultsData","err","console","message","handleBack","role","className","children","onClick","title","length","map","result","studentName","score","totalQuestions","Math","round","Date","submittedAt","toLocaleString","tabSwitches","faceVerificationFailures","multipleFaceDetections","noFaceDetections","_id"],"sources":["C:/Online Exam Proctoring System/frontend/src/components/ResultsPage.js"],"sourcesContent":["// frontend/src/components/ResultsPage.js\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport './ResultsPage.css';\n\nexport default function ResultsPage({ user }) {\n  const { examId } = useParams();\n  const navigate = useNavigate();\n  const [results, setResults] = useState([]);\n  const [examDetails, setExamDetails] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    fetchResults();\n  }, [examId]);\n\n  const fetchResults = async () => {\n    try {\n      setLoading(true);\n      const token = localStorage.getItem('token');\n      \n      // Fetch exam details\n      const examResponse = await fetch(`http://localhost:4000/api/exam/paper/${examId}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      \n      if (!examResponse.ok) throw new Error('Failed to load exam details');\n      const examData = await examResponse.json();\n      setExamDetails(examData);\n      \n      // Fetch results\n      const resultsResponse = await fetch(`http://localhost:4000/api/exam/results/${examId}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      \n      if (!resultsResponse.ok) throw new Error('Failed to load results');\n      const resultsData = await resultsResponse.json();\n      setResults(resultsData);\n      \n    } catch (err) {\n      console.error('Error fetching results:', err);\n      setError(err.message || 'Failed to load results');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleBack = () => {\n    if (user.role === 'admin') {\n      navigate('/admin/dashboard');\n    } else {\n      navigate('/student/dashboard');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"results-container loading\">\n        <div className=\"loading-spinner\"></div>\n        <p>Loading results...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"results-container error\">\n        <h2>Error</h2>\n        <p>{error}</p>\n        <button onClick={handleBack} className=\"btn-back\">Back to Dashboard</button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"results-container\">\n      <div className=\"results-header\">\n        <h1>Exam Results</h1>\n        {examDetails && <h2>{examDetails.title}</h2>}\n        <button onClick={handleBack} className=\"btn-back\">Back to Dashboard</button>\n      </div>\n\n      {results.length === 0 ? (\n        <div className=\"no-results\">\n          <p>No results available for this exam yet.</p>\n        </div>\n      ) : (\n        <div className=\"results-table-container\">\n          <table className=\"results-table\">\n            <thead>\n              <tr>\n                <th>Student</th>\n                <th>Score</th>\n                <th>Percentage</th>\n                <th>Submission Time</th>\n                <th>Proctoring Violations</th>\n                <th>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {results.map((result) => (\n                <tr key={result._id}>\n                  <td>{result.studentName}</td>\n                  <td>{result.score} / {result.totalQuestions}</td>\n                  <td>{Math.round((result.score / result.totalQuestions) * 100)}%</td>\n                  <td>{new Date(result.submittedAt).toLocaleString()}</td>\n                  <td>\n                    <div className=\"violation-indicators\">\n                      {result.tabSwitches > 0 && (\n                        <span className=\"violation-badge\" title={`${result.tabSwitches} tab switches detected`}>\n                          üîÑ {result.tabSwitches}\n                        </span>\n                      )}\n                      {result.faceVerificationFailures > 0 && (\n                        <span className=\"violation-badge\" title={`${result.faceVerificationFailures} face verification failures`}>\n                          üë§‚ùå {result.faceVerificationFailures}\n                        </span>\n                      )}\n                      {result.multipleFaceDetections > 0 && (\n                        <span className=\"violation-badge\" title={`${result.multipleFaceDetections} multiple face detections`}>\n                          üë• {result.multipleFaceDetections}\n                        </span>\n                      )}\n                      {result.noFaceDetections > 0 && (\n                        <span className=\"violation-badge\" title={`${result.noFaceDetections} periods with no face detected`}>\n                          üë§‚ùì {result.noFaceDetections}\n                        </span>\n                      )}\n                      {!result.tabSwitches && !result.faceVerificationFailures && \n                       !result.multipleFaceDetections && !result.noFaceDetections && (\n                        <span className=\"clean-badge\">‚úÖ None</span>\n                      )}\n                    </div>\n                  </td>\n                  <td>\n                    <button \n                      onClick={() => navigate(`/result/${result._id}`)}\n                      className=\"btn-view-details\"\n                    >\n                      View Details\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}