{"ast":null,"code":"var _jsxFileName = \"C:\\\\Online Exam Proctoring System\\\\frontend\\\\src\\\\components\\\\PreExamSetup.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport * as faceapi from \"face-api.js\";\nimport { endpoints } from \"../api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction PreExamSetup({\n  onVerified\n}) {\n  _s();\n  const videoRef = useRef();\n  const [status, setStatus] = useState(\"Checking light and face...\");\n  useEffect(() => {\n    startVideo();\n    loadModels();\n  }, []);\n  const loadModels = async () => {\n    const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\n    await Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL), faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL), faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL)]);\n    console.log(\"Face API models loaded\");\n  };\n  const startVideo = () => {\n    navigator.mediaDevices.getUserMedia({\n      video: true\n    }).then(stream => videoRef.current.srcObject = stream).catch(err => console.error(\"Camera error:\", err));\n  };\n  const handleVerification = async () => {\n    const detections = await faceapi.detectSingleFace(videoRef.current, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceDescriptor();\n    if (!detections) {\n      alert(\"No face detected! Please ensure proper lighting.\");\n      return;\n    }\n    const brightness = await checkLighting(videoRef.current);\n    if (brightness < 80) {\n      alert(\"Lighting too dim! Please increase brightness.\");\n      return;\n    }\n    alert(\"Face & lighting verified successfully!\");\n    onVerified(true);\n  };\n  const checkLighting = async video => {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(video, 0, 0);\n    const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    let sum = 0;\n    for (let i = 0; i < frame.data.length; i += 4) sum += (frame.data[i] + frame.data[i + 1] + frame.data[i + 2]) / 3;\n    return sum / (frame.data.length / 4);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pre-exam-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Pre-Exam Setup\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      muted: true,\n      width: \"400\",\n      height: \"300\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: status\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleVerification,\n      children: \"Verify Setup\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n_s(PreExamSetup, \"htaxl7klWD4H4ZQua9v5r2OVcpw=\");\n_c = PreExamSetup;\nexport default PreExamSetup;\nvar _c;\n$RefreshReg$(_c, \"PreExamSetup\");","map":{"version":3,"names":["React","useEffect","useRef","useState","faceapi","endpoints","jsxDEV","_jsxDEV","PreExamSetup","onVerified","_s","videoRef","status","setStatus","startVideo","loadModels","MODEL_URL","process","env","PUBLIC_URL","Promise","all","nets","tinyFaceDetector","loadFromUri","faceRecognitionNet","faceLandmark68Net","console","log","navigator","mediaDevices","getUserMedia","video","then","stream","current","srcObject","catch","err","error","handleVerification","detections","detectSingleFace","TinyFaceDetectorOptions","withFaceLandmarks","withFaceDescriptor","alert","brightness","checkLighting","canvas","document","createElement","width","videoWidth","height","videoHeight","ctx","getContext","drawImage","frame","getImageData","sum","i","data","length","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","muted","onClick","_c","$RefreshReg$"],"sources":["C:/Online Exam Proctoring System/frontend/src/components/PreExamSetup.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport * as faceapi from \"face-api.js\";\r\nimport { endpoints } from \"../api\";\r\n\r\nfunction PreExamSetup({ onVerified }) {\r\n  const videoRef = useRef();\r\n  const [status, setStatus] = useState(\"Checking light and face...\");\r\n\r\n  useEffect(() => {\r\n    startVideo();\r\n    loadModels();\r\n  }, []);\r\n\r\n  const loadModels = async () => {\r\n    const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\r\n    await Promise.all([\r\n      faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\r\n      faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\r\n      faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\r\n    ]);\r\n    console.log(\"Face API models loaded\");\r\n  };\r\n\r\n  const startVideo = () => {\r\n    navigator.mediaDevices\r\n      .getUserMedia({ video: true })\r\n      .then((stream) => (videoRef.current.srcObject = stream))\r\n      .catch((err) => console.error(\"Camera error:\", err));\r\n  };\r\n\r\n  const handleVerification = async () => {\r\n    const detections = await faceapi\r\n      .detectSingleFace(videoRef.current, new faceapi.TinyFaceDetectorOptions())\r\n      .withFaceLandmarks()\r\n      .withFaceDescriptor();\r\n\r\n    if (!detections) {\r\n      alert(\"No face detected! Please ensure proper lighting.\");\r\n      return;\r\n    }\r\n\r\n    const brightness = await checkLighting(videoRef.current);\r\n    if (brightness < 80) {\r\n      alert(\"Lighting too dim! Please increase brightness.\");\r\n      return;\r\n    }\r\n\r\n    alert(\"Face & lighting verified successfully!\");\r\n    onVerified(true);\r\n  };\r\n\r\n  const checkLighting = async (video) => {\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = video.videoWidth;\r\n    canvas.height = video.videoHeight;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    ctx.drawImage(video, 0, 0);\r\n    const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n    let sum = 0;\r\n    for (let i = 0; i < frame.data.length; i += 4)\r\n      sum += (frame.data[i] + frame.data[i + 1] + frame.data[i + 2]) / 3;\r\n    return sum / (frame.data.length / 4);\r\n  };\r\n\r\n  return (\r\n    <div className=\"pre-exam-container\">\r\n      <h3>Pre-Exam Setup</h3>\r\n      <video ref={videoRef} autoPlay muted width=\"400\" height=\"300\" />\r\n      <p>{status}</p>\r\n      <button onClick={handleVerification}>Verify Setup</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PreExamSetup;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}