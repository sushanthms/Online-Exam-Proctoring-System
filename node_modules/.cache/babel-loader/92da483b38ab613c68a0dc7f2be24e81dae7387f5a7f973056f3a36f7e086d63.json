{"ast":null,"code":"var _jsxFileName = \"C:\\\\Online Exam Proctoring System\\\\frontend\\\\src\\\\components\\\\ExamPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from \"react\";\nimport * as faceapi from \"face-api.js\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport PreExamSetup from \"./PreExamSetup\";\nimport \"./ExamPage.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ExamPage({\n  user,\n  onLogout\n}) {\n  _s();\n  const {\n    examId\n  } = useParams();\n  const videoRef = useRef(null);\n  const [tabSwitchCount, setTabSwitchCount] = useState(0);\n  const [warningShown, setWarningShown] = useState(false);\n  const [timeLeft, setTimeLeft] = useState(600);\n  const [logs, setLogs] = useState([]);\n  const [paper, setPaper] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [currentQ, setCurrentQ] = useState(0);\n  const [showSetup, setShowSetup] = useState(true);\n  const [examData, setExamData] = useState(null);\n  const [registeredDescriptor, setRegisteredDescriptor] = useState(null);\n  const [faceVerificationStatus, setFaceVerificationStatus] = useState(\"loading\");\n  const [verificationFailures, setVerificationFailures] = useState(0);\n  const [lastVerificationTime, setLastVerificationTime] = useState(Date.now());\n  const [modelsLoaded, setModelsLoaded] = useState(false);\n  const multipleFaceActive = useRef(false);\n  const startTimeRef = useRef(null);\n  const isSubmitting = useRef(false);\n  const verificationInterval = useRef(null);\n  const navigate = useNavigate();\n  useEffect(() => {\n    loadRegisteredFace();\n  }, []);\n  const loadRegisteredFace = async () => {\n    try {\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch(\"http://localhost:4000/api/auth/face-descriptor\", {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const data = await response.json();\n        if (data.faceDescriptor && Array.isArray(data.faceDescriptor) && data.faceDescriptor.length === 128) {\n          setRegisteredDescriptor(new Float32Array(data.faceDescriptor));\n          setFaceVerificationStatus(\"ready\");\n        } else {\n          alert(\"Invalid face descriptor. Please re-register your face.\");\n          navigate(\"/face-registration\");\n        }\n      } else {\n        alert(\"Please register your face before taking exams!\");\n        navigate(\"/face-registration\");\n      }\n    } catch (error) {\n      console.error(\"Error loading face descriptor:\", error);\n      setFaceVerificationStatus(\"error\");\n      alert(\"Failed to load face verification. Please try again.\");\n    }\n  };\n  useEffect(() => {\n    const loadModelsAndExam = async () => {\n      try {\n        var _data$questions;\n        const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\n        await Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL), faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL), faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL)]);\n        setModelsLoaded(true);\n        const res = await fetch(`http://localhost:4000/api/exam/paper/${examId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        if (!res.ok) throw new Error(`Server error: ${res.status}`);\n        const data = await res.json();\n        if (!(data !== null && data !== void 0 && (_data$questions = data.questions) !== null && _data$questions !== void 0 && _data$questions.length)) {\n          throw new Error(\"No questions in exam\");\n        }\n        setPaper(data);\n        setAnswers(new Array(data.questions.length).fill(null));\n        setTimeLeft((data.durationMins || 10) * 60);\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: 640,\n            height: 480\n          }\n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      } catch (err) {\n        alert(`Failed to load exam: ${err.message}`);\n        navigate(\"/student/dashboard\");\n      }\n    };\n    loadModelsAndExam();\n  }, [examId, navigate]);\n  useEffect(() => {\n    if (!paper || !registeredDescriptor || !modelsLoaded) return;\n    verificationInterval.current = setInterval(async () => {\n      await verifyFaceIdentity();\n    }, 5000); // Every 5 seconds\n\n    setTimeout(() => verifyFaceIdentity(), 2000);\n    return () => {\n      if (verificationInterval.current) {\n        clearInterval(verificationInterval.current);\n      }\n    };\n  }, [paper, registeredDescriptor, modelsLoaded]);\n  const verifyFaceIdentity = async () => {\n    if (!videoRef.current || !registeredDescriptor) return;\n    try {\n      const detection = await faceapi.detectSingleFace(videoRef.current, new faceapi.TinyFaceDetectorOptions({\n        inputSize: 224\n      })).withFaceLandmarks().withFaceDescriptor();\n      let issues = [];\n      if (!detection) {\n        setLogs(prev => [...prev, `No face detected at ${new Date().toLocaleTimeString()}`]);\n        pushVerificationHistory(false);\n        return;\n      }\n      const distance = faceapi.euclideanDistance(registeredDescriptor, detection.descriptor);\n      const threshold = 0.6;\n      const isMatch = distance < threshold;\n      if (isMatch) {\n        setFaceVerificationStatus(\"verified\");\n        setLastVerificationTime(Date.now());\n        pushVerificationHistory(true);\n      } else {\n        pushVerificationHistory(false);\n        const newCount = verificationFailures + 1;\n        setVerificationFailures(newCount);\n        setLogs(prev => [...prev, `Mismatch #${newCount} at ${new Date().toLocaleTimeString()}`]);\n\n        // Only auto-submit if last 3 consecutive failures\n        const lastThree = [...verificationHistory.slice(-2), false]; // include current\n        if (lastThree.length === 3 && lastThree.every(v => !v)) {\n          alert(\"3 consecutive identity verification failures! Exam will be auto-submitted.\");\n          handleSubmit();\n        }\n      }\n    } catch (error) {\n      console.error(\"Verification error:\", error);\n    }\n  };\n\n  // Tab Switch Detection\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.hidden) setTabSwitchCount(prev => prev + 1);\n    };\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\n    return () => document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n  }, []);\n  const handleSubmit = async () => {\n    if (isSubmitting.current) return;\n    if (!paper) {\n      alert(\"Exam data not loaded!\");\n      return;\n    }\n    if (tabSwitchCount < 3 && timeLeft > 0) {\n      if (!window.confirm(\"Are you sure you want to submit your exam?\")) return;\n    }\n    isSubmitting.current = true;\n    try {\n      const response = await fetch(\"http://localhost:4000/api/exam/submit\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${localStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          userId: user._id,\n          examId: examId,\n          answers: answers\n        })\n      });\n      if (!response.ok) throw new Error(`Submit failed: ${response.status}`);\n      const data = await response.json();\n      if (data.submissionId) navigate(`/result/${data.submissionId}`);else throw new Error(\"No submission ID returned\");\n    } catch (error) {\n      alert(\"Failed to submit exam. Please try again.\");\n      isSubmitting.current = false;\n    }\n  };\n  const handleSetupComplete = () => setShowSetup(false);\n  const handleSetupCancel = () => navigate(\"/student/dashboard\");\n  if (showSetup) {\n    return /*#__PURE__*/_jsxDEV(PreExamSetup, {\n      user: user,\n      examId: examId,\n      examDetails: examData,\n      onProceed: handleSetupComplete,\n      onCancel: handleSetupCancel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 5\n    }, this);\n  }\n  if (!paper || !paper.questions) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading exam...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 231,\n    columnNumber: 42\n  }, this);\n  const question = paper.questions[currentQ];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"exam-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Status: \", faceVerificationStatus, \" | Failures: \", verificationFailures, \"/3\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      muted: true,\n      style: {\n        width: \"300px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 236,\n    columnNumber: 5\n  }, this);\n}\n_s(ExamPage, \"5bZdeoh4j2o1I8h/a0Ei1NitUyY=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ExamPage;\nvar _c;\n$RefreshReg$(_c, \"ExamPage\");","map":{"version":3,"names":["React","useEffect","useState","useRef","faceapi","useNavigate","useParams","PreExamSetup","jsxDEV","_jsxDEV","ExamPage","user","onLogout","_s","examId","videoRef","tabSwitchCount","setTabSwitchCount","warningShown","setWarningShown","timeLeft","setTimeLeft","logs","setLogs","paper","setPaper","answers","setAnswers","currentQ","setCurrentQ","showSetup","setShowSetup","examData","setExamData","registeredDescriptor","setRegisteredDescriptor","faceVerificationStatus","setFaceVerificationStatus","verificationFailures","setVerificationFailures","lastVerificationTime","setLastVerificationTime","Date","now","modelsLoaded","setModelsLoaded","multipleFaceActive","startTimeRef","isSubmitting","verificationInterval","navigate","loadRegisteredFace","token","localStorage","getItem","response","fetch","headers","Authorization","ok","data","json","faceDescriptor","Array","isArray","length","Float32Array","alert","error","console","loadModelsAndExam","_data$questions","MODEL_URL","process","env","PUBLIC_URL","Promise","all","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","res","Error","status","questions","fill","durationMins","stream","navigator","mediaDevices","getUserMedia","video","width","height","current","srcObject","err","message","setInterval","verifyFaceIdentity","setTimeout","clearInterval","detection","detectSingleFace","TinyFaceDetectorOptions","inputSize","withFaceLandmarks","withFaceDescriptor","issues","prev","toLocaleTimeString","pushVerificationHistory","distance","euclideanDistance","descriptor","threshold","isMatch","newCount","lastThree","verificationHistory","slice","every","v","handleSubmit","handleVisibilityChange","document","hidden","addEventListener","removeEventListener","window","confirm","method","body","JSON","stringify","userId","_id","submissionId","handleSetupComplete","handleSetupCancel","examDetails","onProceed","onCancel","fileName","_jsxFileName","lineNumber","columnNumber","children","question","className","ref","autoPlay","muted","style","_c","$RefreshReg$"],"sources":["C:/Online Exam Proctoring System/frontend/src/components/ExamPage.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport * as faceapi from \"face-api.js\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport PreExamSetup from \"./PreExamSetup\";\r\n\r\nimport \"./ExamPage.css\";\r\n\r\nexport default function ExamPage({ user, onLogout }) {\r\n  const { examId } = useParams();\r\n  const videoRef = useRef(null);\r\n  const [tabSwitchCount, setTabSwitchCount] = useState(0);\r\n  const [warningShown, setWarningShown] = useState(false);\r\n  const [timeLeft, setTimeLeft] = useState(600);\r\n  const [logs, setLogs] = useState([]);\r\n  const [paper, setPaper] = useState(null);\r\n  const [answers, setAnswers] = useState([]);\r\n  const [currentQ, setCurrentQ] = useState(0);\r\n\r\n  const [showSetup, setShowSetup] = useState(true);\r\n  const [examData, setExamData] = useState(null);\r\n\r\n  const [registeredDescriptor, setRegisteredDescriptor] = useState(null);\r\n  const [faceVerificationStatus, setFaceVerificationStatus] = useState(\"loading\");\r\n  const [verificationFailures, setVerificationFailures] = useState(0);\r\n  const [lastVerificationTime, setLastVerificationTime] = useState(Date.now());\r\n  const [modelsLoaded, setModelsLoaded] = useState(false);\r\n\r\n  const multipleFaceActive = useRef(false);\r\n  const startTimeRef = useRef(null);\r\n  const isSubmitting = useRef(false);\r\n  const verificationInterval = useRef(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    loadRegisteredFace();\r\n  }, []);\r\n\r\n  const loadRegisteredFace = async () => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      const response = await fetch(\"http://localhost:4000/api/auth/face-descriptor\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n\r\n        if (data.faceDescriptor && Array.isArray(data.faceDescriptor) && data.faceDescriptor.length === 128) {\r\n          setRegisteredDescriptor(new Float32Array(data.faceDescriptor));\r\n          setFaceVerificationStatus(\"ready\");\r\n        } else {\r\n          alert(\"Invalid face descriptor. Please re-register your face.\");\r\n          navigate(\"/face-registration\");\r\n        }\r\n      } else {\r\n        alert(\"Please register your face before taking exams!\");\r\n        navigate(\"/face-registration\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error loading face descriptor:\", error);\r\n      setFaceVerificationStatus(\"error\");\r\n      alert(\"Failed to load face verification. Please try again.\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const loadModelsAndExam = async () => {\r\n      try {\r\n        const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\r\n\r\n        await Promise.all([\r\n          faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\r\n          faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\r\n          faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\r\n        ]);\r\n\r\n        setModelsLoaded(true);\r\n\r\n        const res = await fetch(`http://localhost:4000/api/exam/paper/${examId}`, {\r\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\r\n        });\r\n\r\n        if (!res.ok) throw new Error(`Server error: ${res.status}`);\r\n        const data = await res.json();\r\n\r\n        if (!data?.questions?.length) {\r\n          throw new Error(\"No questions in exam\");\r\n        }\r\n\r\n        setPaper(data);\r\n        setAnswers(new Array(data.questions.length).fill(null));\r\n        setTimeLeft((data.durationMins || 10) * 60);\r\n\r\n        const stream = await navigator.mediaDevices.getUserMedia({\r\n          video: { width: 640, height: 480 }\r\n        });\r\n\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = stream;\r\n        }\r\n      } catch (err) {\r\n        alert(`Failed to load exam: ${err.message}`);\r\n        navigate(\"/student/dashboard\");\r\n      }\r\n    };\r\n\r\n    loadModelsAndExam();\r\n  }, [examId, navigate]);\r\n\r\n  useEffect(() => {\r\n    if (!paper || !registeredDescriptor || !modelsLoaded) return;\r\n\r\n    verificationInterval.current = setInterval(async () => {\r\n      await verifyFaceIdentity();\r\n    }, 5000); // Every 5 seconds\r\n\r\n    setTimeout(() => verifyFaceIdentity(), 2000);\r\n\r\n    return () => {\r\n      if (verificationInterval.current) {\r\n        clearInterval(verificationInterval.current);\r\n      }\r\n    };\r\n  }, [paper, registeredDescriptor, modelsLoaded]);\r\n\r\n  const verifyFaceIdentity = async () => {\r\n  if (!videoRef.current || !registeredDescriptor) return;\r\n\r\n  try {\r\n    const detection = await faceapi\r\n      .detectSingleFace(videoRef.current, new faceapi.TinyFaceDetectorOptions({ inputSize: 224 }))\r\n      .withFaceLandmarks()\r\n      .withFaceDescriptor();\r\n\r\n    let issues = [];\r\n\r\n    if (!detection) {\r\n      setLogs(prev => [...prev, `No face detected at ${new Date().toLocaleTimeString()}`]);\r\n      pushVerificationHistory(false);\r\n      return;\r\n    }\r\n\r\n    const distance = faceapi.euclideanDistance(registeredDescriptor, detection.descriptor);\r\n    const threshold = 0.6;\r\n    const isMatch = distance < threshold;\r\n\r\n    if (isMatch) {\r\n      setFaceVerificationStatus(\"verified\");\r\n      setLastVerificationTime(Date.now());\r\n      pushVerificationHistory(true);\r\n    } else {\r\n      pushVerificationHistory(false);\r\n      const newCount = verificationFailures + 1;\r\n      setVerificationFailures(newCount);\r\n      setLogs(prev => [...prev, `Mismatch #${newCount} at ${new Date().toLocaleTimeString()}`]);\r\n\r\n      // Only auto-submit if last 3 consecutive failures\r\n      const lastThree = [...verificationHistory.slice(-2), false]; // include current\r\n      if (lastThree.length === 3 && lastThree.every(v => !v)) {\r\n        alert(\"3 consecutive identity verification failures! Exam will be auto-submitted.\");\r\n        handleSubmit();\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Verification error:\", error);\r\n  }\r\n};\r\n\r\n  // Tab Switch Detection\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      if (document.hidden) setTabSwitchCount(prev => prev + 1);\r\n    };\r\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\r\n    return () => document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\r\n  }, []);\r\n\r\n  const handleSubmit = async () => {\r\n    if (isSubmitting.current) return;\r\n    if (!paper) {\r\n      alert(\"Exam data not loaded!\");\r\n      return;\r\n    }\r\n\r\n    if (tabSwitchCount < 3 && timeLeft > 0) {\r\n      if (!window.confirm(\"Are you sure you want to submit your exam?\")) return;\r\n    }\r\n\r\n    isSubmitting.current = true;\r\n\r\n    try {\r\n      const response = await fetch(\"http://localhost:4000/api/exam/submit\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"Authorization\": `Bearer ${localStorage.getItem(\"token\")}`\r\n        },\r\n        body: JSON.stringify({\r\n          userId: user._id,\r\n          examId: examId,\r\n          answers: answers,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) throw new Error(`Submit failed: ${response.status}`);\r\n      const data = await response.json();\r\n\r\n      if (data.submissionId) navigate(`/result/${data.submissionId}`);\r\n      else throw new Error(\"No submission ID returned\");\r\n    } catch (error) {\r\n      alert(\"Failed to submit exam. Please try again.\");\r\n      isSubmitting.current = false;\r\n    }\r\n  };\r\n\r\nconst handleSetupComplete = () => setShowSetup(false);\r\n  const handleSetupCancel = () => navigate(\"/student/dashboard\");\r\n\r\n  if (showSetup) {\r\n  return (\r\n    <PreExamSetup\r\n      user={user}\r\n      examId={examId}\r\n      examDetails={examData}\r\n      onProceed={handleSetupComplete}\r\n      onCancel={handleSetupCancel}\r\n    />\r\n  );\r\n}\r\n\r\n  if (!paper || !paper.questions) return <div>Loading exam...</div>;\r\n\r\n  const question = paper.questions[currentQ];\r\n\r\n  return (\r\n    <div className=\"exam-page\">\r\n      <div>\r\n        Status: {faceVerificationStatus} | Failures: {verificationFailures}/3\r\n      </div>\r\n      {/* Exam content here */}\r\n      <video ref={videoRef} autoPlay muted style={{ width: \"300px\" }} />\r\n      {/* Question and answers */}\r\n      {/* ... */}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}