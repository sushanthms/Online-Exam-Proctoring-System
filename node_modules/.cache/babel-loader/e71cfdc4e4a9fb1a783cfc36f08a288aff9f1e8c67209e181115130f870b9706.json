{"ast":null,"code":"var _jsxFileName = \"C:\\\\Online Exam Proctoring System\\\\frontend\\\\src\\\\components\\\\ExamPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from \"react\";\nimport * as faceapi from \"face-api.js\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport PreExamSetup from \"./PreExamSetup\";\nimport \"./ExamPage.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ExamPage({\n  user\n}) {\n  _s();\n  const {\n    examId\n  } = useParams();\n  const navigate = useNavigate();\n\n  // --- References & States ---\n  const videoRef = useRef(null);\n  const verificationInterval = useRef(null);\n  const multipleFaceActive = useRef(false);\n  const startTimeRef = useRef(null);\n  const isSubmitting = useRef(false);\n  const [showSetup, setShowSetup] = useState(true);\n  const [examData, setExamData] = useState(null);\n  const [paper, setPaper] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [currentQ, setCurrentQ] = useState(0);\n  const [timeLeft, setTimeLeft] = useState(600);\n  const [tabSwitchCount, setTabSwitchCount] = useState(0);\n  const [warningShown, setWarningShown] = useState(false);\n  const [logs, setLogs] = useState([]);\n  const [registeredDescriptor, setRegisteredDescriptor] = useState(null);\n  const [modelsLoaded, setModelsLoaded] = useState(false);\n  const [faceVerificationStatus, setFaceVerificationStatus] = useState(\"loading\");\n  const [verificationFailures, setVerificationFailures] = useState(0);\n  const [lastVerificationTime, setLastVerificationTime] = useState(Date.now());\n\n  // --- Pre-Exam Setup Callbacks ---\n  const handleSetupComplete = () => setShowSetup(false);\n  const handleSetupCancel = () => navigate(\"/student/dashboard\");\n\n  // --- Load Registered Face Descriptor ---\n  useEffect(() => {\n    const loadRegisteredFace = async () => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await fetch(\"http://localhost:4000/api/auth/face-descriptor\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        if (!res.ok) throw new Error(\"Face not registered\");\n        const data = await res.json();\n        if (!data.faceDescriptor || data.faceDescriptor.length !== 128) {\n          throw new Error(\"Invalid face descriptor\");\n        }\n        setRegisteredDescriptor(new Float32Array(data.faceDescriptor));\n        setFaceVerificationStatus(\"ready\");\n      } catch (err) {\n        alert(\"‚ö†Ô∏è Please register your face before taking exams!\");\n        navigate(\"/face-registration\");\n      }\n    };\n    loadRegisteredFace();\n  }, [navigate]);\n\n  // --- Load Models & Exam Paper ---\n  useEffect(() => {\n    if (!examId) return;\n    const loadModelsAndExam = async () => {\n      try {\n        const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\n        await Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL), faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL), faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL)]);\n        setModelsLoaded(true);\n        const res = await fetch(`http://localhost:4000/api/exam/paper/${examId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        if (!res.ok) throw new Error(\"Failed to load exam\");\n        const data = await res.json();\n        setExamData(data);\n        setPaper(data);\n        setAnswers(new Array(data.questions.length).fill(null));\n        setTimeLeft((data.durationMins || 10) * 60);\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: 640,\n            height: 480\n          }\n        });\n        if (videoRef.current) videoRef.current.srcObject = stream;\n      } catch (err) {\n        alert(`Failed to load exam: ${err.message}`);\n        navigate(\"/student/dashboard\");\n      }\n    };\n    loadModelsAndExam();\n  }, [examId, navigate]);\n\n  // --- Continuous Face Verification ---\n  useEffect(() => {\n    if (!paper || !registeredDescriptor || !modelsLoaded) return;\n    const verifyFaceIdentity = async () => {\n      if (!videoRef.current) return;\n      try {\n        const detection = await faceapi.detectSingleFace(videoRef.current, new faceapi.TinyFaceDetectorOptions({\n          inputSize: 224\n        })).withFaceLandmarks().withFaceDescriptor();\n        if (!detection) {\n          setLogs(prev => [...prev, `‚ö†Ô∏è No face at ${new Date().toLocaleTimeString()}`]);\n          return;\n        }\n        const distance = faceapi.euclideanDistance(registeredDescriptor, detection.descriptor);\n        const threshold = 0.6;\n        const isMatch = distance < threshold;\n        if (isMatch) {\n          setFaceVerificationStatus(\"verified\");\n          setLastVerificationTime(Date.now());\n        } else {\n          const newCount = verificationFailures + 1;\n          setVerificationFailures(newCount);\n          setLogs(prev => [...prev, `üö® Mismatch #${newCount} at ${new Date().toLocaleTimeString()}`]);\n          alert(`üö® Identity mismatch detected (${newCount}/3)`);\n          if (newCount >= 3) handleSubmit();\n        }\n      } catch (err) {\n        console.error(\"Face verification error:\", err);\n      }\n    };\n    verificationInterval.current = setInterval(verifyFaceIdentity, 5000);\n    setTimeout(verifyFaceIdentity, 2000);\n    return () => clearInterval(verificationInterval.current);\n  }, [paper, registeredDescriptor, modelsLoaded, verificationFailures]);\n\n  // --- Tab switch detection ---\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.hidden) setTabSwitchCount(prev => prev + 1);\n    };\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\n    return () => document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n  }, []);\n  useEffect(() => {\n    if (tabSwitchCount === 2 && !warningShown) {\n      alert(\"‚ö†Ô∏è Warning: One more tab switch will auto-submit your exam.\");\n      setWarningShown(true);\n    } else if (tabSwitchCount >= 3) {\n      alert(\"‚ùå Too many tab switches. Auto-submitting...\");\n      handleSubmit();\n    }\n  }, [tabSwitchCount, warningShown]);\n\n  // --- Timer Countdown ---\n  useEffect(() => {\n    if (timeLeft <= 0) {\n      alert(\"‚è∞ Time's up! Auto-submitting...\");\n      handleSubmit();\n      return;\n    }\n    const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);\n    return () => clearTimeout(timer);\n  }, [timeLeft]);\n\n  // --- Multiple Face Detection ---\n  useEffect(() => {\n    if (!paper) return;\n    const interval = setInterval(async () => {\n      if (!videoRef.current) return;\n      try {\n        const detections = await faceapi.detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions());\n        if (detections.length > 1 && !multipleFaceActive.current) {\n          multipleFaceActive.current = true;\n          startTimeRef.current = new Date();\n          setLogs(prev => [...prev, `Multiple faces detected at ${startTimeRef.current.toLocaleTimeString()}`]);\n        } else if (detections.length <= 1 && multipleFaceActive.current) {\n          multipleFaceActive.current = false;\n          const duration = Math.round((new Date() - startTimeRef.current) / 1000);\n          setLogs(prev => [...prev, `Multiple faces ended (Duration: ${duration}s)`]);\n        }\n      } catch (err) {\n        console.error(\"Multiple face detection error:\", err);\n      }\n    }, 3000);\n    return () => clearInterval(interval);\n  }, [paper]);\n\n  // --- Answer Handling ---\n  const handleAnswerChange = (index, value) => {\n    const newAnswers = [...answers];\n    newAnswers[index] = value;\n    setAnswers(newAnswers);\n  };\n\n  // --- Submit Exam ---\n  const handleSubmit = async () => {\n    if (isSubmitting.current || !paper) return;\n    isSubmitting.current = true;\n    try {\n      const res = await fetch(\"http://localhost:4000/api/exam/submit\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          userId: user._id,\n          examId,\n          answers\n        })\n      });\n      if (!res.ok) throw new Error(\"Submit failed\");\n      const data = await res.json();\n      if (data.submissionId) navigate(`/result/${data.submissionId}`);\n    } catch (err) {\n      alert(\"Failed to submit exam. Try again.\");\n      isSubmitting.current = false;\n    }\n  };\n\n  // --- Pre-Exam Setup ---\n  if (showSetup) {\n    return /*#__PURE__*/_jsxDEV(PreExamSetup, {\n      user: user,\n      examId: examId,\n      examDetails: examData,\n      onProceed: handleSetupComplete,\n      onCancel: handleSetupCancel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this);\n  }\n\n  // --- Render Exam Interface ---\n  if (!paper || !paper.questions) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading exam...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 12\n    }, this);\n  }\n  const question = paper.questions[currentQ];\n  const formatTime = sec => `${Math.floor(sec / 60)}:${sec % 60 < 10 ? \"0\" : \"\"}${sec % 60}`;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"exam-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"exam-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: paper.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Time Left: \", formatTime(timeLeft)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Face Verification: \", faceVerificationStatus]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"exam-body\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"exam-main\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Q\", currentQ + 1, \": \", question.text]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"exam-options\",\n          children: question.options.map((opt, idx) => /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: `q${currentQ}`,\n              checked: answers[currentQ] === idx,\n              onChange: () => handleAnswerChange(currentQ, idx)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 17\n            }, this), opt]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"exam-nav\",\n          children: [currentQ > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setCurrentQ(currentQ - 1),\n            children: \"\\u2B05\\uFE0F Previous\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 30\n          }, this), currentQ < paper.questions.length - 1 ? /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setCurrentQ(currentQ + 1),\n            children: \"Next \\u27A1\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSubmit,\n            children: \"\\uD83D\\uDE80 Submit Exam\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"exam-sidebar\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"\\uD83D\\uDCF7 Camera Monitor\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          autoPlay: true,\n          muted: true,\n          style: {\n            width: \"100%\",\n            maxWidth: \"300px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"\\uD83D\\uDC40 Logs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: logs.length ? logs.map((log, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n            children: log\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 49\n          }, this)) : /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"No issues\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 75\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n}\n_s(ExamPage, \"9AbuUkdRZPpc5G9bBeBfk5f6HTg=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ExamPage;\nvar _c;\n$RefreshReg$(_c, \"ExamPage\");","map":{"version":3,"names":["React","useEffect","useState","useRef","faceapi","useNavigate","useParams","PreExamSetup","jsxDEV","_jsxDEV","ExamPage","user","_s","examId","navigate","videoRef","verificationInterval","multipleFaceActive","startTimeRef","isSubmitting","showSetup","setShowSetup","examData","setExamData","paper","setPaper","answers","setAnswers","currentQ","setCurrentQ","timeLeft","setTimeLeft","tabSwitchCount","setTabSwitchCount","warningShown","setWarningShown","logs","setLogs","registeredDescriptor","setRegisteredDescriptor","modelsLoaded","setModelsLoaded","faceVerificationStatus","setFaceVerificationStatus","verificationFailures","setVerificationFailures","lastVerificationTime","setLastVerificationTime","Date","now","handleSetupComplete","handleSetupCancel","loadRegisteredFace","token","localStorage","getItem","res","fetch","headers","Authorization","ok","Error","data","json","faceDescriptor","length","Float32Array","err","alert","loadModelsAndExam","MODEL_URL","process","env","PUBLIC_URL","Promise","all","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","Array","questions","fill","durationMins","stream","navigator","mediaDevices","getUserMedia","video","width","height","current","srcObject","message","verifyFaceIdentity","detection","detectSingleFace","TinyFaceDetectorOptions","inputSize","withFaceLandmarks","withFaceDescriptor","prev","toLocaleTimeString","distance","euclideanDistance","descriptor","threshold","isMatch","newCount","handleSubmit","console","error","setInterval","setTimeout","clearInterval","handleVisibilityChange","document","hidden","addEventListener","removeEventListener","timer","clearTimeout","interval","detections","detectAllFaces","duration","Math","round","handleAnswerChange","index","value","newAnswers","method","body","JSON","stringify","userId","_id","submissionId","examDetails","onProceed","onCancel","fileName","_jsxFileName","lineNumber","columnNumber","children","question","formatTime","sec","floor","className","title","text","options","map","opt","idx","type","name","checked","onChange","onClick","ref","autoPlay","muted","style","maxWidth","log","i","_c","$RefreshReg$"],"sources":["C:/Online Exam Proctoring System/frontend/src/components/ExamPage.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport * as faceapi from \"face-api.js\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport PreExamSetup from \"./PreExamSetup\";\r\nimport \"./ExamPage.css\";\r\n\r\nexport default function ExamPage({ user }) {\r\n  const { examId } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  // --- References & States ---\r\n  const videoRef = useRef(null);\r\n  const verificationInterval = useRef(null);\r\n  const multipleFaceActive = useRef(false);\r\n  const startTimeRef = useRef(null);\r\n  const isSubmitting = useRef(false);\r\n\r\n  const [showSetup, setShowSetup] = useState(true);\r\n  const [examData, setExamData] = useState(null);\r\n  const [paper, setPaper] = useState(null);\r\n  const [answers, setAnswers] = useState([]);\r\n  const [currentQ, setCurrentQ] = useState(0);\r\n  const [timeLeft, setTimeLeft] = useState(600);\r\n  const [tabSwitchCount, setTabSwitchCount] = useState(0);\r\n  const [warningShown, setWarningShown] = useState(false);\r\n  const [logs, setLogs] = useState([]);\r\n  const [registeredDescriptor, setRegisteredDescriptor] = useState(null);\r\n  const [modelsLoaded, setModelsLoaded] = useState(false);\r\n  const [faceVerificationStatus, setFaceVerificationStatus] = useState(\"loading\");\r\n  const [verificationFailures, setVerificationFailures] = useState(0);\r\n  const [lastVerificationTime, setLastVerificationTime] = useState(Date.now());\r\n\r\n  // --- Pre-Exam Setup Callbacks ---\r\n  const handleSetupComplete = () => setShowSetup(false);\r\n  const handleSetupCancel = () => navigate(\"/student/dashboard\");\r\n\r\n  // --- Load Registered Face Descriptor ---\r\n  useEffect(() => {\r\n    const loadRegisteredFace = async () => {\r\n      try {\r\n        const token = localStorage.getItem(\"token\");\r\n        const res = await fetch(\"http://localhost:4000/api/auth/face-descriptor\", {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n\r\n        if (!res.ok) throw new Error(\"Face not registered\");\r\n\r\n        const data = await res.json();\r\n        if (!data.faceDescriptor || data.faceDescriptor.length !== 128) {\r\n          throw new Error(\"Invalid face descriptor\");\r\n        }\r\n\r\n        setRegisteredDescriptor(new Float32Array(data.faceDescriptor));\r\n        setFaceVerificationStatus(\"ready\");\r\n      } catch (err) {\r\n        alert(\"‚ö†Ô∏è Please register your face before taking exams!\");\r\n        navigate(\"/face-registration\");\r\n      }\r\n    };\r\n    loadRegisteredFace();\r\n  }, [navigate]);\r\n\r\n  // --- Load Models & Exam Paper ---\r\n  useEffect(() => {\r\n    if (!examId) return;\r\n\r\n    const loadModelsAndExam = async () => {\r\n      try {\r\n        const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\r\n        await Promise.all([\r\n          faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\r\n          faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\r\n          faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\r\n        ]);\r\n        setModelsLoaded(true);\r\n\r\n        const res = await fetch(`http://localhost:4000/api/exam/paper/${examId}`, {\r\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\r\n        });\r\n        if (!res.ok) throw new Error(\"Failed to load exam\");\r\n\r\n        const data = await res.json();\r\n        setExamData(data);\r\n        setPaper(data);\r\n        setAnswers(new Array(data.questions.length).fill(null));\r\n        setTimeLeft((data.durationMins || 10) * 60);\r\n\r\n        const stream = await navigator.mediaDevices.getUserMedia({ video: { width: 640, height: 480 } });\r\n        if (videoRef.current) videoRef.current.srcObject = stream;\r\n      } catch (err) {\r\n        alert(`Failed to load exam: ${err.message}`);\r\n        navigate(\"/student/dashboard\");\r\n      }\r\n    };\r\n\r\n    loadModelsAndExam();\r\n  }, [examId, navigate]);\r\n\r\n  // --- Continuous Face Verification ---\r\n  useEffect(() => {\r\n    if (!paper || !registeredDescriptor || !modelsLoaded) return;\r\n\r\n    const verifyFaceIdentity = async () => {\r\n      if (!videoRef.current) return;\r\n      try {\r\n        const detection = await faceapi\r\n          .detectSingleFace(videoRef.current, new faceapi.TinyFaceDetectorOptions({ inputSize: 224 }))\r\n          .withFaceLandmarks()\r\n          .withFaceDescriptor();\r\n\r\n        if (!detection) {\r\n          setLogs((prev) => [...prev, `‚ö†Ô∏è No face at ${new Date().toLocaleTimeString()}`]);\r\n          return;\r\n        }\r\n\r\n        const distance = faceapi.euclideanDistance(registeredDescriptor, detection.descriptor);\r\n        const threshold = 0.6;\r\n        const isMatch = distance < threshold;\r\n\r\n        if (isMatch) {\r\n          setFaceVerificationStatus(\"verified\");\r\n          setLastVerificationTime(Date.now());\r\n        } else {\r\n          const newCount = verificationFailures + 1;\r\n          setVerificationFailures(newCount);\r\n          setLogs((prev) => [...prev, `üö® Mismatch #${newCount} at ${new Date().toLocaleTimeString()}`]);\r\n          alert(`üö® Identity mismatch detected (${newCount}/3)`);\r\n\r\n          if (newCount >= 3) handleSubmit();\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Face verification error:\", err);\r\n      }\r\n    };\r\n\r\n    verificationInterval.current = setInterval(verifyFaceIdentity, 5000);\r\n    setTimeout(verifyFaceIdentity, 2000);\r\n\r\n    return () => clearInterval(verificationInterval.current);\r\n  }, [paper, registeredDescriptor, modelsLoaded, verificationFailures]);\r\n\r\n  // --- Tab switch detection ---\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      if (document.hidden) setTabSwitchCount((prev) => prev + 1);\r\n    };\r\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\r\n    return () => document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (tabSwitchCount === 2 && !warningShown) {\r\n      alert(\"‚ö†Ô∏è Warning: One more tab switch will auto-submit your exam.\");\r\n      setWarningShown(true);\r\n    } else if (tabSwitchCount >= 3) {\r\n      alert(\"‚ùå Too many tab switches. Auto-submitting...\");\r\n      handleSubmit();\r\n    }\r\n  }, [tabSwitchCount, warningShown]);\r\n\r\n  // --- Timer Countdown ---\r\n  useEffect(() => {\r\n    if (timeLeft <= 0) {\r\n      alert(\"‚è∞ Time's up! Auto-submitting...\");\r\n      handleSubmit();\r\n      return;\r\n    }\r\n    const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);\r\n    return () => clearTimeout(timer);\r\n  }, [timeLeft]);\r\n\r\n  // --- Multiple Face Detection ---\r\n  useEffect(() => {\r\n    if (!paper) return;\r\n    const interval = setInterval(async () => {\r\n      if (!videoRef.current) return;\r\n      try {\r\n        const detections = await faceapi.detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions());\r\n        if (detections.length > 1 && !multipleFaceActive.current) {\r\n          multipleFaceActive.current = true;\r\n          startTimeRef.current = new Date();\r\n          setLogs((prev) => [...prev, `Multiple faces detected at ${startTimeRef.current.toLocaleTimeString()}`]);\r\n        } else if (detections.length <= 1 && multipleFaceActive.current) {\r\n          multipleFaceActive.current = false;\r\n          const duration = Math.round((new Date() - startTimeRef.current) / 1000);\r\n          setLogs((prev) => [...prev, `Multiple faces ended (Duration: ${duration}s)`]);\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Multiple face detection error:\", err);\r\n      }\r\n    }, 3000);\r\n    return () => clearInterval(interval);\r\n  }, [paper]);\r\n\r\n  // --- Answer Handling ---\r\n  const handleAnswerChange = (index, value) => {\r\n    const newAnswers = [...answers];\r\n    newAnswers[index] = value;\r\n    setAnswers(newAnswers);\r\n  };\r\n\r\n  // --- Submit Exam ---\r\n  const handleSubmit = async () => {\r\n    if (isSubmitting.current || !paper) return;\r\n    isSubmitting.current = true;\r\n\r\n    try {\r\n      const res = await fetch(\"http://localhost:4000/api/exam/submit\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n        },\r\n        body: JSON.stringify({ userId: user._id, examId, answers }),\r\n      });\r\n      if (!res.ok) throw new Error(\"Submit failed\");\r\n      const data = await res.json();\r\n      if (data.submissionId) navigate(`/result/${data.submissionId}`);\r\n    } catch (err) {\r\n      alert(\"Failed to submit exam. Try again.\");\r\n      isSubmitting.current = false;\r\n    }\r\n  };\r\n\r\n  // --- Pre-Exam Setup ---\r\n  if (showSetup) {\r\n    return (\r\n      <PreExamSetup\r\n        user={user}\r\n        examId={examId}\r\n        examDetails={examData}\r\n        onProceed={handleSetupComplete}\r\n        onCancel={handleSetupCancel}\r\n      />\r\n    );\r\n  }\r\n\r\n  // --- Render Exam Interface ---\r\n  if (!paper || !paper.questions) {\r\n    return <div>Loading exam...</div>;\r\n  }\r\n\r\n  const question = paper.questions[currentQ];\r\n  const formatTime = (sec) => `${Math.floor(sec / 60)}:${sec % 60 < 10 ? \"0\" : \"\"}${sec % 60}`;\r\n\r\n  return (\r\n    <div className=\"exam-page\">\r\n      <div className=\"exam-header\">\r\n        <h2>{paper.title}</h2>\r\n        <p>Time Left: {formatTime(timeLeft)}</p>\r\n        <p>Face Verification: {faceVerificationStatus}</p>\r\n      </div>\r\n\r\n      <div className=\"exam-body\">\r\n        <div className=\"exam-main\">\r\n          <h3>Q{currentQ + 1}: {question.text}</h3>\r\n          <div className=\"exam-options\">\r\n            {question.options.map((opt, idx) => (\r\n              <label key={idx}>\r\n                <input\r\n                  type=\"radio\"\r\n                  name={`q${currentQ}`}\r\n                  checked={answers[currentQ] === idx}\r\n                  onChange={() => handleAnswerChange(currentQ, idx)}\r\n                />\r\n                {opt}\r\n              </label>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"exam-nav\">\r\n            {currentQ > 0 && <button onClick={() => setCurrentQ(currentQ - 1)}>‚¨ÖÔ∏è Previous</button>}\r\n            {currentQ < paper.questions.length - 1\r\n              ? <button onClick={() => setCurrentQ(currentQ + 1)}>Next ‚û°Ô∏è</button>\r\n              : <button onClick={handleSubmit}>üöÄ Submit Exam</button>\r\n            }\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"exam-sidebar\">\r\n          <h4>üì∑ Camera Monitor</h4>\r\n          <video ref={videoRef} autoPlay muted style={{ width: \"100%\", maxWidth: \"300px\" }} />\r\n          <h4>üëÄ Logs</h4>\r\n          <ul>\r\n            {logs.length ? logs.map((log, i) => <li key={i}>{log}</li>) : <li>No issues</li>}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}