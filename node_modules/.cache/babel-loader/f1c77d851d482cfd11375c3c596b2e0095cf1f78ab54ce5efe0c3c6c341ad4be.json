{"ast":null,"code":"var _jsxFileName = \"C:\\\\Online Exam Proctoring System\\\\frontend\\\\src\\\\components\\\\PreExamSetup.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport * as faceapi from \"face-api.js\";\nimport { useNavigate } from \"react-router-dom\";\nimport \"./PreExamSetup.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PreExamSetup({\n  user,\n  examId,\n  examDetails,\n  onProceed,\n  onCancel\n}) {\n  _s();\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [registeredDescriptor, setRegisteredDescriptor] = useState(null);\n  const [checks, setChecks] = useState({\n    camera: {\n      status: 'pending',\n      message: 'Checking camera access...'\n    },\n    models: {\n      status: 'pending',\n      message: 'Loading face detection models...'\n    },\n    faceDetection: {\n      status: 'pending',\n      message: 'Waiting for face detection...'\n    },\n    lighting: {\n      status: 'pending',\n      message: 'Checking lighting conditions...'\n    },\n    identity: {\n      status: 'pending',\n      message: 'Verifying your identity...'\n    },\n    singlePerson: {\n      status: 'pending',\n      message: 'Checking for single person...'\n    }\n  });\n  const [canProceed, setCanProceed] = useState(false);\n  const [verificationHistory, setVerificationHistory] = useState([]); // Track last few results\n  const [currentIssues, setCurrentIssues] = useState([]);\n  const detectionInterval = useRef(null);\n  useEffect(() => {\n    startSystemCheck();\n    return () => {\n      stopCamera();\n      if (detectionInterval.current) clearInterval(detectionInterval.current);\n    };\n  }, []);\n  const stopCamera = () => {\n    var _videoRef$current;\n    if ((_videoRef$current = videoRef.current) !== null && _videoRef$current !== void 0 && _videoRef$current.srcObject) {\n      videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n    }\n  };\n  const startSystemCheck = async () => {\n    await checkCamera();\n    await loadModels();\n    await loadRegisteredFace();\n    startContinuousChecks();\n  };\n  const checkCamera = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: 640,\n          height: 480,\n          facingMode: \"user\"\n        }\n      });\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        await new Promise(resolve => {\n          videoRef.current.onloadedmetadata = () => {\n            videoRef.current.play();\n            resolve();\n          };\n        });\n        updateCheck(\"camera\", \"success\", \"‚úì Camera connected\");\n      }\n    } catch (error) {\n      updateCheck(\"camera\", \"error\", \"‚úó Camera access denied\");\n    }\n  };\n  const loadModels = async () => {\n    try {\n      const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\n      await Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL), faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL), faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL)]);\n      updateCheck(\"models\", \"success\", \"‚úì Detection models loaded\");\n    } catch (error) {\n      updateCheck(\"models\", \"error\", \"‚úó Failed to load detection models\");\n    }\n  };\n  const loadRegisteredFace = async () => {\n    try {\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch(\"http://localhost:4000/api/auth/face-descriptor\", {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        var _data$faceDescriptor;\n        const data = await response.json();\n        if (((_data$faceDescriptor = data.faceDescriptor) === null || _data$faceDescriptor === void 0 ? void 0 : _data$faceDescriptor.length) === 128) {\n          setRegisteredDescriptor(new Float32Array(data.faceDescriptor));\n        } else {\n          throw new Error(\"Invalid face descriptor\");\n        }\n      } else {\n        throw new Error(\"Face not registered\");\n      }\n    } catch (error) {\n      updateCheck(\"identity\", \"error\", \"‚úó Face not registered. Please register first.\");\n    }\n  };\n  const startContinuousChecks = () => {\n    detectionInterval.current = setInterval(async () => {\n      await performAllChecks();\n    }, 1000);\n  };\n  const performAllChecks = async () => {\n    if (!videoRef.current || videoRef.current.readyState !== 4) {\n      console.log(\"Video not ready yet\");\n      return;\n    }\n    if (!registeredDescriptor) {\n      console.log(\"Registered face descriptor not loaded yet\");\n      return;\n    }\n    try {\n      const detections = await faceapi.detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions({\n        inputSize: 224\n      })).withFaceLandmarks().withFaceDescriptors();\n      console.log(\"Detections:\", detections);\n      const issues = [];\n\n      // --- Face detection ---\n      if (detections.length === 0) {\n        updateCheck(\"faceDetection\", \"warning\", \"‚ö† No face detected\");\n        updateCheck(\"identity\", \"pending\", \"Waiting for face...\");\n        updateCheck(\"singlePerson\", \"pending\", \"Waiting for face...\");\n        issues.push(\"Position your face in front of the camera\");\n        pushVerificationHistory(false);\n        setCurrentIssues(issues);\n        setCanProceed(false);\n        return;\n      } else {\n        updateCheck(\"faceDetection\", \"success\", \"‚úì Face detected\");\n      }\n\n      // --- Single person check ---\n      if (detections.length > 1) {\n        updateCheck(\"singlePerson\", \"error\", `‚úó ${detections.length} people detected`);\n        issues.push(\"Multiple people detected. Only you should be visible.\");\n        pushVerificationHistory(false);\n        setCurrentIssues(issues);\n        setCanProceed(false);\n        return;\n      } else {\n        updateCheck(\"singlePerson\", \"success\", \"‚úì Single person confirmed\");\n      }\n\n      // --- Lighting check ---\n      const detection = detections[0];\n      const lightingScore = detection.detection.score;\n      if (lightingScore < 0.3) {\n        updateCheck(\"lighting\", \"warning\", \"‚ö† Poor lighting - improve lighting\");\n        issues.push(\"Lighting is poor. Please improve lighting conditions.\");\n      } else if (lightingScore < 0.6) {\n        updateCheck(\"lighting\", \"warning\", \"‚ö† Lighting could be better\");\n        issues.push(\"Lighting could be improved for better detection.\");\n      } else {\n        updateCheck(\"lighting\", \"success\", \"‚úì Lighting is good\");\n      }\n\n      // --- Identity check ---\n      const distance = faceapi.euclideanDistance(registeredDescriptor, detection.descriptor);\n      const threshold = 0.6;\n      const isMatch = distance < threshold;\n      const confidence = (1 - distance) * 100;\n      if (isMatch) {\n        console.log(\"Identity verified:\", confidence.toFixed(1));\n        updateCheck(\"identity\", \"success\", `‚úì Identity verified (${confidence.toFixed(1)}% match)`);\n        pushVerificationHistory(isMatch, issues);\n      } else {\n        console.log(\"Identity mismatch:\", confidence.toFixed(1));\n        updateCheck(\"identity\", \"error\", `‚úó Identity mismatch (${confidence.toFixed(1)}% match)`);\n        issues.push(\"Face doesn't match registered face.\");\n        pushVerificationHistory(isMatch, issues);\n      }\n      setCurrentIssues(issues);\n\n      // --- Determine canProceed ---\n      const lastTwo = verificationHistory.slice(-2); // For testing, use 2 instead of 3\n      const windowCheck = [...lastTwo, isMatch];\n      console.log(\"Verification sliding window:\", windowCheck);\n      if (windowCheck.length === 3 && windowCheck.every(v => v) && issues.length === 0) {\n        setCanProceed(true);\n        console.log(\"‚úÖ All checks passed! Can proceed.\");\n      } else {\n        setCanProceed(false);\n      }\n\n      // --- Draw canvas ---\n      if (canvasRef.current) {\n        const dims = faceapi.matchDimensions(canvasRef.current, videoRef.current, true);\n        const resizedDetections = faceapi.resizeResults(detections, dims);\n        const ctx = canvasRef.current.getContext(\"2d\");\n        ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n        faceapi.draw.drawDetections(canvasRef.current, resizedDetections);\n        faceapi.draw.drawFaceLandmarks(canvasRef.current, resizedDetections);\n      }\n    } catch (error) {\n      console.error(\"Error in performAllChecks:\", error);\n    }\n  };\n\n  // --- Sliding window helper ---\n  const pushVerificationHistory = (result, issues) => {\n    setVerificationHistory(prev => {\n      const newHistory = [...prev.slice(-2), result]; // keep last 2 + new = 3\n      const windowCheck = newHistory;\n      if (windowCheck.length === 3 && windowCheck.every(v => v) && issues.length === 0) {\n        setCanProceed(true);\n        console.log(\"‚úÖ All checks passed! Can proceed.\");\n      } else {\n        setCanProceed(false);\n      }\n      console.log(\"Verification sliding window:\", windowCheck);\n      return newHistory;\n    });\n  };\n\n  // till here perform all checks\n  const updateCheck = (checkName, status, message) => {\n    setChecks(prev => ({\n      ...prev,\n      [checkName]: {\n        status,\n        message\n      }\n    }));\n  };\n  const handleProceed = () => {\n    if (canProceed) {\n      stopCamera();\n      onProceed();\n    }\n  };\n  const handleCancel = () => {\n    stopCamera();\n    onCancel();\n  };\n  const getStatusIcon = status => {\n    switch (status) {\n      case \"success\":\n        return \"‚úì\";\n      case \"error\":\n        return \"‚úó\";\n      case \"warning\":\n        return \"‚ö†\";\n      case \"pending\":\n        return \"‚è≥\";\n      default:\n        return \"‚óã\";\n    }\n  };\n  const getStatusClass = status => `check-item status-${status}`;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pre-exam-setup\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"setup-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"setup-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\uD83D\\uDCF8 Pre-Exam System Check\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please ensure all checks pass before starting the exam\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"setup-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"camera-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"camera-preview\",\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              ref: videoRef,\n              autoPlay: true,\n              muted: true,\n              className: \"preview-video\",\n              onLoadedMetadata: () => {\n                if (canvasRef.current && videoRef.current) {\n                  canvasRef.current.width = videoRef.current.videoWidth;\n                  canvasRef.current.height = videoRef.current.videoHeight;\n                }\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n              ref: canvasRef,\n              className: \"preview-canvas\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this), currentIssues.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"current-issues\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"\\u26A0\\uFE0F Current Issues:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: currentIssues.map((issue, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: issue\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checks-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"System Checks\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"checks-list\",\n            children: Object.entries(checks).map(([key, value]) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: getStatusClass(value.status),\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"check-icon\",\n                children: getStatusIcon(value.status)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 308,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"check-message\",\n                children: value.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 309,\n                columnNumber: 19\n              }, this)]\n            }, key, true, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"setup-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCancel,\n          className: \"btn-cancel\",\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleProceed,\n          disabled: !canProceed,\n          className: \"btn-proceed\",\n          children: canProceed ? \"‚úì Start Exam\" : \"‚è≥ Waiting for all checks\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 267,\n    columnNumber: 5\n  }, this);\n}\n_s(PreExamSetup, \"ETAAoMXOe0bzD/ei6v6kgE725xg=\");\n_c = PreExamSetup;\nvar _c;\n$RefreshReg$(_c, \"PreExamSetup\");","map":{"version":3,"names":["React","useEffect","useRef","useState","faceapi","useNavigate","jsxDEV","_jsxDEV","PreExamSetup","user","examId","examDetails","onProceed","onCancel","_s","videoRef","canvasRef","registeredDescriptor","setRegisteredDescriptor","checks","setChecks","camera","status","message","models","faceDetection","lighting","identity","singlePerson","canProceed","setCanProceed","verificationHistory","setVerificationHistory","currentIssues","setCurrentIssues","detectionInterval","startSystemCheck","stopCamera","current","clearInterval","_videoRef$current","srcObject","getTracks","forEach","track","stop","checkCamera","loadModels","loadRegisteredFace","startContinuousChecks","stream","navigator","mediaDevices","getUserMedia","video","width","height","facingMode","Promise","resolve","onloadedmetadata","play","updateCheck","error","MODEL_URL","process","env","PUBLIC_URL","all","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","token","localStorage","getItem","response","fetch","headers","Authorization","ok","_data$faceDescriptor","data","json","faceDescriptor","length","Float32Array","Error","setInterval","performAllChecks","readyState","console","log","detections","detectAllFaces","TinyFaceDetectorOptions","inputSize","withFaceLandmarks","withFaceDescriptors","issues","push","pushVerificationHistory","detection","lightingScore","score","distance","euclideanDistance","descriptor","threshold","isMatch","confidence","toFixed","lastTwo","slice","windowCheck","every","v","dims","matchDimensions","resizedDetections","resizeResults","ctx","getContext","clearRect","draw","drawDetections","drawFaceLandmarks","result","prev","newHistory","checkName","handleProceed","handleCancel","getStatusIcon","getStatusClass","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","muted","onLoadedMetadata","videoWidth","videoHeight","map","issue","index","Object","entries","key","value","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Online Exam Proctoring System/frontend/src/components/PreExamSetup.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport * as faceapi from \"face-api.js\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"./PreExamSetup.css\";\r\n\r\nexport default function PreExamSetup({ user, examId, examDetails, onProceed, onCancel }) {\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const [registeredDescriptor, setRegisteredDescriptor] = useState(null);\r\n\r\n  const [checks, setChecks] = useState({\r\n    camera: { status: 'pending', message: 'Checking camera access...' },\r\n    models: { status: 'pending', message: 'Loading face detection models...' },\r\n    faceDetection: { status: 'pending', message: 'Waiting for face detection...' },\r\n    lighting: { status: 'pending', message: 'Checking lighting conditions...' },\r\n    identity: { status: 'pending', message: 'Verifying your identity...' },\r\n    singlePerson: { status: 'pending', message: 'Checking for single person...' }\r\n  });\r\n\r\n  const [canProceed, setCanProceed] = useState(false);\r\nconst [verificationHistory, setVerificationHistory] = useState([]); // Track last few results\r\n  const [currentIssues, setCurrentIssues] = useState([]);\r\n  const detectionInterval = useRef(null);\r\n\r\n  useEffect(() => {\r\n    startSystemCheck();\r\n    return () => {\r\n      stopCamera();\r\n      if (detectionInterval.current) clearInterval(detectionInterval.current);\r\n    };\r\n  }, []);\r\n\r\n  const stopCamera = () => {\r\n    if (videoRef.current?.srcObject) {\r\n      videoRef.current.srcObject.getTracks().forEach(track => track.stop());\r\n    }\r\n  };\r\n\r\n  const startSystemCheck = async () => {\r\n    await checkCamera();\r\n    await loadModels();\r\n    await loadRegisteredFace();\r\n    startContinuousChecks();\r\n  };\r\n\r\n  const checkCamera = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        video: { width: 640, height: 480, facingMode: \"user\" }\r\n      });\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n        await new Promise(resolve => {\r\n          videoRef.current.onloadedmetadata = () => {\r\n            videoRef.current.play();\r\n            resolve();\r\n          };\r\n        });\r\n        updateCheck(\"camera\", \"success\", \"‚úì Camera connected\");\r\n      }\r\n    } catch (error) {\r\n      updateCheck(\"camera\", \"error\", \"‚úó Camera access denied\");\r\n    }\r\n  };\r\n\r\n  const loadModels = async () => {\r\n    try {\r\n      const MODEL_URL = process.env.PUBLIC_URL + \"/models\";\r\n      await Promise.all([\r\n        faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\r\n        faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\r\n        faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\r\n      ]);\r\n      updateCheck(\"models\", \"success\", \"‚úì Detection models loaded\");\r\n    } catch (error) {\r\n      updateCheck(\"models\", \"error\", \"‚úó Failed to load detection models\");\r\n    }\r\n  };\r\n\r\n  const loadRegisteredFace = async () => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      const response = await fetch(\"http://localhost:4000/api/auth/face-descriptor\", {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        if (data.faceDescriptor?.length === 128) {\r\n          setRegisteredDescriptor(new Float32Array(data.faceDescriptor));\r\n        } else {\r\n          throw new Error(\"Invalid face descriptor\");\r\n        }\r\n      } else {\r\n        throw new Error(\"Face not registered\");\r\n      }\r\n    } catch (error) {\r\n      updateCheck(\"identity\", \"error\", \"‚úó Face not registered. Please register first.\");\r\n    }\r\n  };\r\n\r\n  const startContinuousChecks = () => {\r\n    detectionInterval.current = setInterval(async () => {\r\n      await performAllChecks();\r\n    }, 1000);\r\n  };\r\n\r\nconst performAllChecks = async () => {\r\n  if (!videoRef.current || videoRef.current.readyState !== 4) {\r\n    console.log(\"Video not ready yet\");\r\n    return;\r\n  }\r\n\r\n  if (!registeredDescriptor) {\r\n    console.log(\"Registered face descriptor not loaded yet\");\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const detections = await faceapi\r\n      .detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions({ inputSize: 224 }))\r\n      .withFaceLandmarks()\r\n      .withFaceDescriptors();\r\n\r\n    console.log(\"Detections:\", detections);\r\n\r\n    const issues = [];\r\n\r\n    // --- Face detection ---\r\n    if (detections.length === 0) {\r\n      updateCheck(\"faceDetection\", \"warning\", \"‚ö† No face detected\");\r\n      updateCheck(\"identity\", \"pending\", \"Waiting for face...\");\r\n      updateCheck(\"singlePerson\", \"pending\", \"Waiting for face...\");\r\n      issues.push(\"Position your face in front of the camera\");\r\n      pushVerificationHistory(false);\r\n      setCurrentIssues(issues);\r\n      setCanProceed(false);\r\n      return;\r\n    } else {\r\n      updateCheck(\"faceDetection\", \"success\", \"‚úì Face detected\");\r\n    }\r\n\r\n    // --- Single person check ---\r\n    if (detections.length > 1) {\r\n      updateCheck(\"singlePerson\", \"error\", `‚úó ${detections.length} people detected`);\r\n      issues.push(\"Multiple people detected. Only you should be visible.\");\r\n      pushVerificationHistory(false);\r\n      setCurrentIssues(issues);\r\n      setCanProceed(false);\r\n      return;\r\n    } else {\r\n      updateCheck(\"singlePerson\", \"success\", \"‚úì Single person confirmed\");\r\n    }\r\n\r\n    // --- Lighting check ---\r\n    const detection = detections[0];\r\n    const lightingScore = detection.detection.score;\r\n    if (lightingScore < 0.3) {\r\n      updateCheck(\"lighting\", \"warning\", \"‚ö† Poor lighting - improve lighting\");\r\n      issues.push(\"Lighting is poor. Please improve lighting conditions.\");\r\n    } else if (lightingScore < 0.6) {\r\n      updateCheck(\"lighting\", \"warning\", \"‚ö† Lighting could be better\");\r\n      issues.push(\"Lighting could be improved for better detection.\");\r\n    } else {\r\n      updateCheck(\"lighting\", \"success\", \"‚úì Lighting is good\");\r\n    }\r\n\r\n    // --- Identity check ---\r\n    const distance = faceapi.euclideanDistance(registeredDescriptor, detection.descriptor);\r\n    const threshold = 0.6;\r\n    const isMatch = distance < threshold;\r\n    const confidence = (1 - distance) * 100;\r\n\r\n    if (isMatch) {\r\n      console.log(\"Identity verified:\", confidence.toFixed(1));\r\n      updateCheck(\"identity\", \"success\", `‚úì Identity verified (${confidence.toFixed(1)}% match)`);\r\npushVerificationHistory(isMatch, issues);\r\n    } else {\r\n      console.log(\"Identity mismatch:\", confidence.toFixed(1));\r\n      updateCheck(\"identity\", \"error\", `‚úó Identity mismatch (${confidence.toFixed(1)}% match)`);\r\n      issues.push(\"Face doesn't match registered face.\");\r\npushVerificationHistory(isMatch, issues);\r\n    }\r\n\r\n    setCurrentIssues(issues);\r\n\r\n    // --- Determine canProceed ---\r\n    const lastTwo = verificationHistory.slice(-2); // For testing, use 2 instead of 3\r\n    const windowCheck = [...lastTwo, isMatch];\r\n    console.log(\"Verification sliding window:\", windowCheck);\r\n\r\n    if (windowCheck.length === 3 && windowCheck.every(v => v) && issues.length === 0) {\r\n      setCanProceed(true);\r\n      console.log(\"‚úÖ All checks passed! Can proceed.\");\r\n    } else {\r\n      setCanProceed(false);\r\n    }\r\n\r\n    // --- Draw canvas ---\r\n    if (canvasRef.current) {\r\n      const dims = faceapi.matchDimensions(canvasRef.current, videoRef.current, true);\r\n      const resizedDetections = faceapi.resizeResults(detections, dims);\r\n      const ctx = canvasRef.current.getContext(\"2d\");\r\n      ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n      faceapi.draw.drawDetections(canvasRef.current, resizedDetections);\r\n      faceapi.draw.drawFaceLandmarks(canvasRef.current, resizedDetections);\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error(\"Error in performAllChecks:\", error);\r\n  }\r\n};\r\n\r\n// --- Sliding window helper ---\r\nconst pushVerificationHistory = (result, issues) => {\r\n  setVerificationHistory(prev => {\r\n    const newHistory = [...prev.slice(-2), result]; // keep last 2 + new = 3\r\n    const windowCheck = newHistory;\r\n\r\n    if (windowCheck.length === 3 && windowCheck.every(v => v) && issues.length === 0) {\r\n      setCanProceed(true);\r\n      console.log(\"‚úÖ All checks passed! Can proceed.\");\r\n    } else {\r\n      setCanProceed(false);\r\n    }\r\n\r\n    console.log(\"Verification sliding window:\", windowCheck);\r\n    return newHistory;\r\n  });\r\n};\r\n\r\n\r\n\r\n\r\n// till here perform all checks\r\n  const updateCheck = (checkName, status, message) => {\r\n    setChecks((prev) => ({\r\n      ...prev,\r\n      [checkName]: { status, message }\r\n    }));\r\n  };\r\n\r\n  const handleProceed = () => {\r\n    if (canProceed) {\r\n      stopCamera();\r\n      onProceed();\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    stopCamera();\r\n    onCancel();\r\n  };\r\n\r\n  const getStatusIcon = (status) => {\r\n    switch (status) {\r\n      case \"success\": return \"‚úì\";\r\n      case \"error\": return \"‚úó\";\r\n      case \"warning\": return \"‚ö†\";\r\n      case \"pending\": return \"‚è≥\";\r\n      default: return \"‚óã\";\r\n    }\r\n  };\r\n\r\n  const getStatusClass = (status) => `check-item status-${status}`;\r\n\r\n  return (\r\n    <div className=\"pre-exam-setup\">\r\n      <div className=\"setup-container\">\r\n        <div className=\"setup-header\">\r\n          <h2>üì∏ Pre-Exam System Check</h2>\r\n          <p>Please ensure all checks pass before starting the exam</p>\r\n        </div>\r\n\r\n        <div className=\"setup-content\">\r\n          <div className=\"camera-section\">\r\n            <div className=\"camera-preview\">\r\n              <video\r\n                ref={videoRef}\r\n                autoPlay\r\n                muted\r\n                className=\"preview-video\"\r\n                onLoadedMetadata={() => {\r\n                  if (canvasRef.current && videoRef.current) {\r\n                    canvasRef.current.width = videoRef.current.videoWidth;\r\n                    canvasRef.current.height = videoRef.current.videoHeight;\r\n                  }\r\n                }}\r\n              />\r\n              <canvas ref={canvasRef} className=\"preview-canvas\" />\r\n            </div>\r\n            {currentIssues.length > 0 && (\r\n              <div className=\"current-issues\">\r\n                <h4>‚ö†Ô∏è Current Issues:</h4>\r\n                <ul>\r\n                  {currentIssues.map((issue, index) => (\r\n                    <li key={index}>{issue}</li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"checks-section\">\r\n            <h3>System Checks</h3>\r\n            <div className=\"checks-list\">\r\n              {Object.entries(checks).map(([key, value]) => (\r\n                <div key={key} className={getStatusClass(value.status)}>\r\n                  <span className=\"check-icon\">{getStatusIcon(value.status)}</span>\r\n                  <span className=\"check-message\">{value.message}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"setup-actions\">\r\n          <button onClick={handleCancel} className=\"btn-cancel\">Cancel</button>\r\n          <button onClick={handleProceed} disabled={!canProceed} className=\"btn-proceed\">\r\n            {canProceed ? \"‚úì Start Exam\" : \"‚è≥ Waiting for all checks\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}